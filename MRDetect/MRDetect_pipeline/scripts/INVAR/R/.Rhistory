geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.7)
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], "black", colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_grid(Patient ~ .)+ #, scales = "free_x"
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "ctDNA over time for all patients")+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.5)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.5)
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], "black", colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_grid(Patient ~ .)+ #, scales = "free_x"
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "ctDNA over time for all patients")+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.5)+
geom_jitter(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.5, height = 0)
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], "black", colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_grid(Patient ~ .)+ #, scales = "free_x"
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "ctDNA over time for all patients")+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.3)+
geom_jitter(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.3)
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], "black", colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_grid(Patient ~ .)+ #, scales = "free_x"
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "ctDNA over time for all patients")+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.3)+
geom_jitter(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.5)
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.3)+
geom_jitter(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.5)
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], "black", colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_grid(Patient ~ .)+ #, scales = "free_x"
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.3)+
geom_jitter(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.5)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], "black", colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_grid(Patient ~ .)+ #, scales = "free_x"
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "ctDNA over time for all patients")
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.3)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.5)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], "black", colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_grid(Patient ~ .)+ #, scales = "free_x"
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "ctDNA over time for all patients")
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.3)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.5)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], alpha("black", 0.7), colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_grid(Patient ~ .)+ #, scales = "free_x"
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "ctDNA over time for all patients")
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.3)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.5)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], alpha("black", 0.5), colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.5)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_grid(Patient ~ .)+ #, scales = "free_x"
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "ctDNA over time for all patients")
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.3)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.5)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], alpha("black", 0.5), colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.5)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_grid(Patient ~ ., scales = "free_x")+ #
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "ctDNA over time for all patients")
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.3)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.5)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], alpha("black", 0.5), colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.5)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_wrap(~Patient, scales = "free_x")+ #
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "ctDNA over time for all patients")
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.5)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.5)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], alpha("black", 0.5), colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.5)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_wrap(~Patient, scales = "free_x")+ #
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "ctDNA over time for all patients")
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.7)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.7)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], alpha("black", 0.7), colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_wrap(~Patient, scales = "free_x")+ #
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "ctDNA over time for all patients")
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.7)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.7)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], alpha("black", 0.7), colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_wrap(~Patient, scales = "free_x")+ #
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "TAm-Seq (red) vs. TAPAS (black)")
tamseq <- read.table(file = paste0(tapas_mount_point, "group_folders/TAPAS/INVAR_EXPT/JXP0096/JXP0096_tamseq.txt"), header = T)
ctDNA$pt_timepoint <- paste0(ctDNA$Patient, "_", ctDNA$Timepoint)
tamseq$pt_timepoint <- paste0(tamseq$patient, "_", tamseq$Timepoint)
tamseq <- tamseq[tamseq$pt_timepoint %in% ctDNA$pt_timepoint, ]
# only take patients which demonstrate the point for the main figure
non_detected_pts <- unique(filter(tamseq, detection == FALSE)$patient)
tamseq <- tamseq#[tamseq$patient %in% non_detected_pts, ]
ctDNA.nondetected <- ctDNA#[ctDNA$Patient %in% non_detected_pts,]
ctDNA.nondetected$data <- "TAPAS"
tamseq$data <- "TAm-Seq"
colnames(tamseq)[2] <- "Patient"
colnames(tamseq)[6] <- "variable"
# annotate Tam-seq data with time
tamseq$Timepoint <- as.character(tamseq$Timepoint)
tamseq$detection <- factor(tamseq$detection)
tamseq <- left_join(tamseq, ctDNA.nondetected[,c(1,2,4)], by = c("Patient", "Timepoint"))
tapas_tamseq <- rbind.fill(tamseq[,colnames(ctDNA.nondetected)[1:6]], ctDNA.nondetected)
tapas_tamseq$Patient <- factor(tapas_tamseq$Patient, levels = unique(tapas_tamseq$Patient))
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.7)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.7)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], alpha("black", 0.7), colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(1e-6, 1), breaks = c(1e-6, 1e-4, 1e-2, 1))+ #
# scale_y_log10()+
facet_wrap(~Patient, scales = "free_x")+ #
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "TAm-Seq (red) vs. TAPAS (black)")
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.7)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.7)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], alpha("black", 0.7), colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(5e-8,5e-1),
breaks = c(1e-7, 1e-6, 1e-4, 1e-2),
labels = c("ND", "1e-06", "1e-04", "1e-02"))+ #
# scale_y_log10()+
facet_wrap(~Patient, scales = "free_x")+ #
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "TAm-Seq (red) vs. TAPAS (black)")
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.7)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.7)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], alpha("black", 0.7), colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(5e-8,1),
breaks = c(1e-7, 1e-6, 1e-4, 1e-2, 1),
labels = c("ND", "1e-06", "1e-04", "1e-02", "1"))+ #
# scale_y_log10()+
facet_wrap(~Patient, scales = "free_x")+ #
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "TAm-Seq (red) vs. TAPAS (black)")
tapas_tamseq[tapas_tamseq$detection == FALSE]
tapas_tamseq[tapas_tamseq$detection == FALSE,]
tapas_tamseq[tapas_tamseq$detection == FALSE,'variable']
tapas_tamseq[tapas_tamseq$detection == FALSE,'variable'] <- 1e-7
ggplot(filter(tapas_tamseq, data == "TAPAS"), aes(x = time, y= variable, group= Patient))+
geom_rect(aes(xmin = start, xmax = stop, ymin= 0, ymax = Inf, fill = Treatment),
alpha = 0.25, colour = NA)+
geom_line(data = filter(tapas_tamseq, data == "TAm-Seq"), size = 1.1, colour = "red", alpha = 0.7)+
geom_point(data = filter(tapas_tamseq, data == "TAm-Seq"),
shape = 21,
aes(fill = detection),
size = 2,
show.legend = F, colour = "red", alpha = 0.7)+
geom_line(size = 1.1, alpha = 0.7)+
scale_fill_manual(values = c(colours[1], "white", colours[2:5], alpha("black", 0.7), colours[6]))+
geom_point(shape = 21, aes(fill = detection), size = 2, show.legend = F, alpha = 0.7)+
scale_y_log10(limits = c(5e-8,1),
breaks = c(1e-7, 1e-6, 1e-4, 1e-2, 1),
labels = c("ND", "1e-06", "1e-04", "1e-02", "1"))+ #
# scale_y_log10()+
facet_wrap(~Patient, scales = "free_x")+ #
theme_bw()+
guides(colour = F)+
labs(x = "Time",
y = "ctDNA fraction",
title = "TAm-Seq (red) vs. TAPAS (black)")
left_join(filter(tapas_tamseq, detection == FALSE)[,c(1,2,6)],
filter(tapas_tamseq, detection == TRUE)[,c(1,2,6)],
by = c("Patient", "Timepoint"))
left_join(filter(tapas_tamseq, detection == FALSE)[,c(1,2,3,6)],
filter(tapas_tamseq, detection == TRUE)[,c(1,2,3,6)],
by = c("Patient", "Timepoint"))
left_join(filter(tapas_tamseq, data == "TAm-Seq")[,c(1,2,3,6)],
filter(tapas_tamseq, data == "TAPAS")[,c(1,2,3,6)],
by = c("Patient", "Timepoint"))
merged <- left_join(filter(tapas_tamseq, data == "TAm-Seq")[,c(1,2,3,6)],
filter(tapas_tamseq, data == "TAPAS")[,c(1,2,3,6)],
by = c("Patient", "Timepoint"))
paste0(merged$Patient, merged$Timepoint)
paste0(merged$Patient, "_", merged$Timepoint)
merged$uniq <- paste0(merged$Patient, "_", merged$Timepoint)
merged[!duplicated(merged$uniq),]
merged <- merged[!duplicated(merged$uniq),]
View(merged)
ggplot(merged, aes(x = variable.x, y = variable.y))+
geom_point()+
scale_y_log10()+
scale_x_log10()
ggplot(merged, aes(x = variable.x, y = variable.y))+
geom_point()+
scale_y_log10()+
scale_x_log10()+
labs(x = "Allele fraction - amplicon sequencing",
y = "Allele fraction - capture sequencing",
title = "TAm-Seq (red) vs. TAPAS (black) AFs")
ggplot(merged, aes(x = variable.x, y = variable.y))+
geom_point()+
scale_y_log10()+
scale_x_log10()+
labs(x = "Allele fraction - amplicon sequencing",
y = "Allele fraction - capture sequencing",
title = "TAm-Seq (red) vs. TAPAS (black) AFs")+ #
theme_bw()
merged$variable.x
merged$variable.x == 1e-7
merged[merged$variable.x == 1e-7,'variable.x']
merged[merged$variable.x == 1e-7, 'variable.x']
merged[merged$variable.x == 1e-7, 'variable.x'] <- 1e-5
ggplot(merged, aes(x = variable.x, y = variable.y))+
geom_point()+
scale_y_log10()+
scale_x_log10()+
labs(x = "Allele fraction - amplicon sequencing",
y = "Allele fraction - capture sequencing",
title = "TAm-Seq (red) vs. TAPAS (black) AFs")+ #
theme_bw()
ggplot(merged, aes(x = variable.x, y = variable.y))+
geom_point()+
scale_y_log10(breaks = c(1e-5, 1e-4, 1e-2, 1),
labels = c("ND", "1e-04", "1e-02", "1"))+
scale_x_log10()+
labs(x = "Allele fraction - amplicon sequencing",
y = "Allele fraction - capture sequencing",
title = "TAm-Seq (red) vs. TAPAS (black) AFs")+ #
theme_bw()
ggplot(merged, aes(x = variable.x, y = variable.y))+
geom_point()+
scale_y_log10(breaks = c(1e-5, 1e-4, 1e-2, 1),
labels = c("ND", "1e-04", "1e-02", "1"))+
scale_x_log10()+
labs(x = "Allele fraction - amplicon sequencing",
y = "Allele fraction - capture sequencing",
title = "TAm-Seq (red) vs. TAPAS (black) AFs")+ #
theme_bw()
ggplot(merged, aes(x = variable.x, y = variable.y))+
geom_point()+
scale_x_log10(breaks = c(1e-5, 1e-4, 1e-2, 1),
labels = c("ND", "1e-04", "1e-02", "1"))+
scale_y_log10()+
labs(x = "Allele fraction - amplicon sequencing",
y = "Allele fraction - capture sequencing",
title = "TAm-Seq (red) vs. TAPAS (black) AFs")+ #
theme_bw()
ggplot(merged, aes(x = variable.x, y = variable.y))+
geom_point()+
scale_x_log10(breaks = c(1e-5, 1e-4, 1e-2, 1),
labels = c("ND", "1e-04", "1e-02", "1"))+
scale_y_log10()+
labs(x = "Allele fraction - amplicon sequencing",
y = "Allele fraction - capture sequencing",
title = "TAm-Seq (red) vs. TAPAS (black) AFs")+ #
theme_bw()
ggplot(merged, aes(x = variable.x, y = variable.y))+
geom_point()+
geom_smooth(method = "lm")+
scale_x_log10(breaks = c(1e-5, 1e-4, 1e-2, 1),
labels = c("ND", "1e-04", "1e-02", "1"))+
scale_y_log10()+
labs(x = "Allele fraction - amplicon sequencing",
y = "Allele fraction - capture sequencing",
title = "TAm-Seq (red) vs. TAPAS (black) AFs")+ #
theme_bw()
ggplot(merged, aes(x = variable.x, y = variable.y))+
geom_point()+
geom_smooth(method = "lm")+
scale_x_log10(breaks = c(1e-5, 1e-4, 1e-2, 1),
labels = c("ND", "1e-04", "1e-02", "1"))+
scale_y_log10()+
labs(x = "Allele fraction - amplicon sequencing",
y = "Allele fraction - capture sequencing",
title = "TAm-Seq (red) vs. TAPAS (black) AFs")+ #
theme_bw()+
geom_abline(slope = 1)
ggplot(merged, aes(x = variable.x, y = variable.y))+
geom_point()+
#geom_smooth(method = "lm")+
scale_x_log10(breaks = c(1e-5, 1e-4, 1e-2, 1),
labels = c("ND", "1e-04", "1e-02", "1"))+
scale_y_log10()+
labs(x = "Allele fraction - amplicon sequencing",
y = "Allele fraction - capture sequencing",
title = "TAm-Seq (red) vs. TAPAS (black) AFs")+ #
theme_bw()+
geom_abline(slope = 1, linetype = "dashed")
ggsave(paste0(plot_dir, "p78_amplicon_vs_capture.pdf"), width = 6, height = 4)
ggsave(paste0(plot_dir, "p78_amplicon_vs_capture.pdf"), width = 5, height = 4)
